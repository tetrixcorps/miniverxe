---
// Code Academy Modal Component
---

<div id="code-academy-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-50 hidden">
  <div class="flex items-center justify-center min-h-screen p-4">
    <div class="bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-hidden">
      <!-- Modal Header -->
      <div class="bg-gradient-to-r from-blue-600 via-purple-600 to-indigo-600 p-6">
        <div class="flex items-center justify-between">
          <div>
            <h2 class="text-3xl font-bold text-white mb-2">TETRIX Code Academy</h2>
            <p class="text-white/90">Enterprise-grade coding education with AI-powered assistance</p>
          </div>
          <button id="close-code-academy-modal" class="text-white hover:text-white/80 transition-colors">
            <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
          </button>
        </div>
      </div>

      <!-- Modal Content -->
      <div class="p-6 overflow-y-auto max-h-[calc(90vh-120px)]">
        <!-- Hero Section -->
        <div class="text-center mb-8">
          <div class="w-20 h-20 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4">
            <span class="text-3xl text-white">&#128187;</span>
          </div>
          <h3 class="text-2xl font-bold text-gray-900 mb-4">Learn to Code with AI Assistance</h3>
          <p class="text-gray-600 max-w-2xl mx-auto">
            Master programming languages, frameworks, and best practices with our AI-powered learning platform. 
            Get real-time assistance, collaborative coding, and personalized learning paths.
          </p>
        </div>

        <!-- Features Grid -->
        <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8">
          <!-- AI Assistant -->
          <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-xl border border-blue-200">
            <div class="w-12 h-12 bg-blue-600 rounded-lg flex items-center justify-center mb-4">
              <span class="text-white text-xl">&#129302;</span>
            </div>
            <h4 class="text-lg font-bold text-gray-900 mb-2">AI Coding Assistant</h4>
            <p class="text-gray-600 text-sm mb-3">Get instant help with SHANGO AI agent for code review, debugging, and explanations.</p>
            <div class="flex flex-wrap gap-2">
              <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-semibold">Real-time Help</span>
              <span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-semibold">Voice Input</span>
            </div>
          </div>

          <!-- Interactive Learning -->
          <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-xl border border-purple-200">
            <div class="w-12 h-12 bg-purple-600 rounded-lg flex items-center justify-center mb-4">
              <span class="text-white text-xl">&#128218;</span>
            </div>
            <h4 class="text-lg font-bold text-gray-900 mb-2">Interactive Courses</h4>
            <p class="text-gray-600 text-sm mb-3">Hands-on coding exercises with instant feedback and progress tracking.</p>
            <div class="flex flex-wrap gap-2">
              <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded-full text-xs font-semibold">Live Coding</span>
              <span class="bg-purple-100 text-purple-800 px-2 py-1 rounded-full text-xs font-semibold">Progress Tracking</span>
            </div>
          </div>

          <!-- Collaboration -->
          <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-xl border border-green-200">
            <div class="w-12 h-12 bg-green-600 rounded-lg flex items-center justify-center mb-4">
              <span class="text-white text-xl">&#128101;</span>
            </div>
            <h4 class="text-lg font-bold text-gray-900 mb-2">Collaborative Learning</h4>
            <p class="text-gray-600 text-sm mb-3">Work together on projects with real-time collaboration and peer review.</p>
            <div class="flex flex-wrap gap-2">
              <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-semibold">Real-time Sync</span>
              <span class="bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-semibold">Peer Review</span>
            </div>
          </div>

          <!-- Enterprise Features -->
          <div class="bg-gradient-to-br from-orange-50 to-orange-100 p-6 rounded-xl border border-orange-200">
            <div class="w-12 h-12 bg-orange-600 rounded-lg flex items-center justify-center mb-4">
              <span class="text-white text-xl">&#127970;</span>
            </div>
            <h4 class="text-lg font-bold text-gray-900 mb-2">Enterprise Ready</h4>
            <p class="text-gray-600 text-sm mb-3">Team management, analytics, and custom learning paths for organizations.</p>
            <div class="flex flex-wrap gap-2">
              <span class="bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-semibold">Team Analytics</span>
              <span class="bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-semibold">Custom Paths</span>
            </div>
          </div>

          <!-- Voice Learning -->
          <div class="bg-gradient-to-br from-red-50 to-red-100 p-6 rounded-xl border border-red-200">
            <div class="w-12 h-12 bg-red-600 rounded-lg flex items-center justify-center mb-4">
              <span class="text-white text-xl">&#127908;</span>
            </div>
            <h4 class="text-lg font-bold text-gray-900 mb-2">Voice Learning</h4>
            <p class="text-gray-600 text-sm mb-3">Ask questions using voice commands with advanced speech-to-text technology.</p>
            <div class="flex flex-wrap gap-2">
              <span class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs font-semibold">Voice Commands</span>
              <span class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs font-semibold">Deepgram AI</span>
            </div>
          </div>

          <!-- Security -->
          <div class="bg-gradient-to-br from-gray-50 to-gray-100 p-6 rounded-xl border border-gray-200">
            <div class="w-12 h-12 bg-gray-800 rounded-lg flex items-center justify-center mb-4">
              <span class="text-white text-xl">&#128274;</span>
            </div>
            <h4 class="text-lg font-bold text-gray-900 mb-2">Secure & Compliant</h4>
            <p class="text-gray-600 text-sm mb-3">Enterprise-grade security with 2FA, SOC II compliance, and data protection.</p>
            <div class="flex flex-wrap gap-2">
              <span class="bg-gray-200 text-gray-800 px-2 py-1 rounded-full text-xs font-semibold">2FA Protected</span>
              <span class="bg-gray-200 text-gray-800 px-2 py-1 rounded-full text-xs font-semibold">SOC II</span>
            </div>
          </div>
        </div>

        <!-- Technology Stack -->
        <div class="mb-8">
          <h3 class="text-2xl font-bold text-gray-900 mb-6 text-center">Modern Technology Stack</h3>
          <div class="grid md:grid-cols-2 gap-8">
            <div>
              <h4 class="text-lg font-semibold text-gray-900 mb-4">Frontend Technologies</h4>
              <div class="space-y-2">
                <div class="flex items-center space-x-3">
                  <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
                    <span class="text-blue-600 font-bold text-sm">R</span>
                  </div>
                  <span class="text-gray-700">React with Vite</span>
                </div>
                <div class="flex items-center space-x-3">
                  <div class="w-8 h-8 bg-cyan-100 rounded-lg flex items-center justify-center">
                    <span class="text-cyan-600 font-bold text-sm">T</span>
                  </div>
                  <span class="text-gray-700">Tailwind CSS</span>
                </div>
                <div class="flex items-center space-x-3">
                  <div class="w-8 h-8 bg-yellow-100 rounded-lg flex items-center justify-center">
                    <span class="text-yellow-600 font-bold text-sm">TS</span>
                  </div>
                  <span class="text-gray-700">TypeScript</span>
                </div>
              </div>
            </div>
            <div>
              <h4 class="text-lg font-semibold text-gray-900 mb-4">Backend Technologies</h4>
              <div class="space-y-2">
                <div class="flex items-center space-x-3">
                  <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center">
                    <span class="text-green-600 font-bold text-sm">N</span>
                  </div>
                  <span class="text-gray-700">Node.js & Express</span>
                </div>
                <div class="flex items-center space-x-3">
                  <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center">
                    <span class="text-blue-600 font-bold text-sm">P</span>
                  </div>
                  <span class="text-gray-700">PostgreSQL</span>
                </div>
                <div class="flex items-center space-x-3">
                  <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center">
                    <span class="text-purple-600 font-bold text-sm">S</span>
                  </div>
                  <span class="text-gray-700">Socket.io</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Learning Paths -->
        <div class="mb-8">
          <h3 class="text-2xl font-bold text-gray-900 mb-6 text-center">Learning Paths</h3>
          <div class="grid md:grid-cols-3 gap-6">
            <div class="bg-gradient-to-br from-blue-50 to-blue-100 p-6 rounded-xl border border-blue-200">
              <div class="text-3xl mb-4">&#128640;</div>
              <h4 class="text-xl font-bold text-gray-900 mb-3">Beginner</h4>
              <ul class="space-y-2 text-gray-600 mb-4">
                <li>&#8226; HTML & CSS Fundamentals</li>
                <li>&#8226; JavaScript Basics</li>
                <li>&#8226; Git Version Control</li>
                <li>&#8226; Introduction to React</li>
              </ul>
              <div class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-semibold">
                4-6 weeks
              </div>
            </div>
            <div class="bg-gradient-to-br from-purple-50 to-purple-100 p-6 rounded-xl border border-purple-200">
              <div class="text-3xl mb-4">&#9889;</div>
              <h4 class="text-xl font-bold text-gray-900 mb-3">Intermediate</h4>
              <ul class="space-y-2 text-gray-600 mb-4">
                <li>&#8226; Advanced React & Hooks</li>
                <li>&#8226; Node.js & Express</li>
                <li>&#8226; Database Design</li>
                <li>&#8226; API Development</li>
              </ul>
              <div class="bg-purple-100 text-purple-800 px-3 py-1 rounded-full text-sm font-semibold">
                6-8 weeks
              </div>
            </div>
            <div class="bg-gradient-to-br from-green-50 to-green-100 p-6 rounded-xl border border-green-200">
              <div class="text-3xl mb-4">&#127942;</div>
              <h4 class="text-xl font-bold text-gray-900 mb-3">Advanced</h4>
              <ul class="space-y-2 text-gray-600 mb-4">
                <li>&#8226; Microservices Architecture</li>
                <li>&#8226; Cloud Deployment</li>
                <li>&#8226; DevOps & CI/CD</li>
                <li>&#8226; AI Integration</li>
              </ul>
              <div class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-semibold">
                8-12 weeks
              </div>
            </div>
          </div>
        </div>

        <!-- CTA Section -->
        <div class="text-center bg-gradient-to-r from-blue-600 to-purple-600 rounded-xl p-8 text-white">
          <h3 class="text-2xl font-bold mb-4">Ready to Start Your Coding Journey?</h3>
          <p class="text-blue-100 mb-6 max-w-2xl mx-auto">
            Join thousands of developers learning with our AI-powered platform. 
            Get personalized assistance, collaborate with peers, and master modern technologies.
          </p>
          <div class="flex flex-col sm:flex-row gap-4 justify-center">
            <button id="start-learning-btn" class="bg-white text-blue-600 px-8 py-3 rounded-lg font-semibold hover:bg-blue-50 transition-colors shadow-lg">
              Start Learning Now
            </button>
            <button id="view-demo-btn" class="bg-blue-500 text-white px-8 py-3 rounded-lg font-semibold hover:bg-blue-400 transition-colors border border-blue-400">
              View Demo
            </button>
            <button id="open-ai-assistant-btn" class="bg-gradient-to-r from-purple-600 to-pink-600 text-white px-8 py-3 rounded-lg font-semibold hover:from-purple-700 hover:to-pink-700 transition-colors shadow-lg">
              Try AI Assistant
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  // Code Academy Modal functionality
  const openCodeAcademyModal = document.getElementById('open-code-academy-modal');
  const openCodeAcademyModalMobile = document.getElementById('open-code-academy-modal-mobile');
  const codeAcademyModal = document.getElementById('code-academy-modal');
  const closeCodeAcademyModal = document.getElementById('close-code-academy-modal');
  const startLearningBtn = document.getElementById('start-learning-btn');
  const viewDemoBtn = document.getElementById('view-demo-btn');
  const openAIAssistantBtn = document.getElementById('open-ai-assistant-btn');

  // Open modal handlers
  if (openCodeAcademyModal) {
    openCodeAcademyModal.addEventListener('click', function(e) {
      e.preventDefault();
      codeAcademyModal?.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    });
  }

  if (openCodeAcademyModalMobile) {
    openCodeAcademyModalMobile.addEventListener('click', function(e) {
      e.preventDefault();
      codeAcademyModal?.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    });
  }

  // Close modal handlers
  if (closeCodeAcademyModal) {
    closeCodeAcademyModal.addEventListener('click', function() {
      codeAcademyModal?.classList.add('hidden');
      document.body.style.overflow = 'auto';
    });
  }

  // Close on backdrop click
  if (codeAcademyModal) {
    codeAcademyModal.addEventListener('click', function(e) {
      if (e.target === codeAcademyModal) {
        codeAcademyModal.classList.add('hidden');
        document.body.style.overflow = 'auto';
      }
    });
  }

  // Action buttons
  if (startLearningBtn) {
    startLearningBtn.addEventListener('click', function() {
      // Check if user is already authenticated
      const authToken = localStorage.getItem('tetrix_auth_token');
      
      if (authToken) {
        // User is authenticated, redirect to Code Academy domain
        const codeAcademyUrl = window.location.hostname.includes('tetrixcorp.com') 
          ? '/code-academy' 
          : 'http://localhost:3001';
        window.location.href = codeAcademyUrl;
      } else {
        // User needs to authenticate first, show 2FA modal
        if (window.open2FAModal) {
          // Set authentication context for Code Academy
          window.tetrixAuthContext = 'code-academy';
          window.open2FAModal();
        } else {
          // Fallback to direct redirect if 2FA modal not available
          const codeAcademyUrl = window.location.hostname.includes('tetrixcorp.com') 
            ? '/code-academy' 
            : 'http://localhost:3001';
          window.location.href = codeAcademyUrl;
        }
      }
    });
  }

  if (viewDemoBtn) {
    viewDemoBtn.addEventListener('click', function() {
      // Open demo in new tab
      window.open('/code-academy/demo', '_blank');
    });
  }

  if (openAIAssistantBtn) {
    openAIAssistantBtn.addEventListener('click', function() {
      // Open AI Assistant modal
      if (window.openAIAssistantModal) {
        window.openAIAssistantModal('learning');
      } else {
        // Fallback: redirect to Code Academy with AI Assistant
        const codeAcademyUrl = window.location.hostname.includes('tetrixcorp.com') 
          ? '/code-academy?ai-assistant=true' 
          : 'http://localhost:3001?ai-assistant=true';
        window.location.href = codeAcademyUrl;
      }
    });
  }

  // Make functions globally available
  (window as any).openCodeAcademyModal = function() {
    codeAcademyModal?.classList.remove('hidden');
    document.body.style.overflow = 'hidden';
  };

  (window as any).closeCodeAcademyModal = function() {
    codeAcademyModal?.classList.add('hidden');
    document.body.style.overflow = 'auto';
  };
</script>
